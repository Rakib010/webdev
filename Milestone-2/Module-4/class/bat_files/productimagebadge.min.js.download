var ekmProductImageBadges=function(){"use strict";var e=["blue-10%off","blue-15%off","blue-20%off","blue-25%off","blue-50%off","blue-75%off","blue-bestdeal","blue-bestseller","blue-clearance","blue-exclusive","blue-freedelivery","blue-halfprice","blue-lastchance","blue-limitededition","blue-newin","blue-onlineexclusive","blue-perfectgift","blue-premium","blue-sale","blue-specialoffer","blue-top10","blue-top5","green-10%off","green-15%off","green-20%off","green-25%off","green-50%off","green-75%off","green-bestdeal","green-bestseller","green-clearance","green-exclusive","green-freedelivery","green-freedelivery1","green-lastchance","green-limitededition","green-newin","green-onlineexclusive","green-perfectgift","green-premium","green-sale","green-specialoffer","green-top10","green-top5","red-10%off","red-15%off","red-20%off","red-25%off","red-50%off","red-75%off","red-bestdeal","red-bestseller","red-clearance","red-exclusive","red-freedelivery","red-halfprice","red-lastchance","red-limitededition","red-newin","red-onlineexclusive","red-perfectgift","red-premium","red-sale","red-specialoffer","red-top10","red-top5","yellow-10%off","yellow-15%off","yellow-20%off","yellow-25%off","yellow-50%off","yellow-75%off","yellow-bestdeal","yellow-bestseller","yellow-clearance","yellow-exclusive","yellow-freedelivery","yellow-halfprice","yellow-lastchance","yellow-limitededition","yellow-newin","yellow-onlineexclusive","yellow-perfectgift","yellow-premium","yellow-sale","yellow-specialoffer","yellow-top10","yellow-top5"],t=["blue-10%off","blue-15%off","blue-20%off","blue-25%off","blue-50%off","blue-75%off","blue-bestdeal","blue-bestseller","blue-clearance","blue-exclusive","blue-freedelivery","blue-halfprice","blue-lastchance","blue-limitededition","blue-newin","blue-onlineexclusive","blue-perfectgift","blue-premium","blue-sale","blue-specialoffer","blue-top10","blue-top5","green-10%off","green-15%off","green-20%off","green-25%off","green-50%off","green-75%off","green-bestdeal","green-bestseller","green-clearance","green-exclusive","green-freedelivery","green-halfprice","green-lastchance","green-limitededition","green-newin","green-onlineexclusive","green-perfectgift","green-premium","green-sale","green-specialoffer","green-top10","green-top5","orange-10%off","orange-15%off","orange-20%off","orange-25%off","orange-50%off","orange-75%off","orange-bestdeal","orange-bestseller","orange-clearance","orange-exclusive","orange-freedelivery","orange-halfprice","orange-lastchance","orange-limitededition","orange-newin","orange-onlineexclusive","orange-perfectgift","orange-premium","orange-sale","orange-specialoffer","orange-top10","orange-top5","pink-10%off","pink-15%off","pink-20%off","pink-25%off","pink-50%off","pink-75%off","pink-bestdeal","pink-bestseller","pink-clearance","pink-exclusive","pink-freedelivery","pink-halfprice","pink-lastchance","pink-limitededition","pink-newin","pink-onlineexclusive","pink-perfectgift","pink-premium","pink-sale","pink-specialoffer","pink-top10","pink-top5","purple-10%off","purple-15%off","purple-20%off","purple-25%off","purple-50%off","purple-75%off","purple-bestdeal","purple-bestseller","purple-clearance","purple-exclusive","purple-freedelivery","purple-halfprice","purple-lastchance","purple-limitededition","purple-newin","purple-onlineexclusive","purple-perfectgift","purple-premium","purple-sale","purple-specialoffer","purple-top10","purple-top5","red-10%off","red-15%off","red-20%off","red-25%off","red-50%off","red-75%off","red-bestdeal","red-bestseller","red-clearance","red-exclusive","red-freedelivery","red-halfprice","red-lastchance","red-limitededition","red-newin","red-onlineexclusive","red-perfectgift","red-premium","red-sale","red-specialoffer","red-top10","red-top5","yellow-10%off","yellow-15%off","yellow-20%off","yellow-25%off","yellow-50%off","yellow-75%off","yellow-bestdeal","yellow-bestseller","yellow-clearance","yellow-exclusive","yellow-freedelivery","yellow-halfprice","yellow-lastchance","yellow-limitededition","yellow-newin","yellow-onlineexclusive","yellow-perfectgift","yellow-premium","yellow-sale","yellow-specialoffer","yellow-top10","yellow-top5"],l="product badge",r=new WeakMap,n=function(){let e=0;[...document.querySelectorAll(".ekm-product-image-badge-preload")].forEach(t=>{e++,r.has(t)&&r.get(t)()})},i=function(e,t,n){var i=document.createElement("img");i.className="ekm-product-image-badge-preload",i.setAttribute("src",e),i.setAttribute("alt",l);var a=document.getElementsByTagName("body")[0];if(a.appendChild(i),i.complete){n(e,t,i.width,i.height),a.removeChild(i);return}var o=!1;function f(){!o&&(clearTimeout(s),i.onload=function(){},i.parentNode&&i.parentNode.removeChild(i))}i.onload=function(){setTimeout(function(){o||(o=!0,n(e,t,i.width,i.height),a.removeChild(i))},100)};var s=setTimeout(f,5e3);r.set(i,f)},a=function(e,t,l,r){var n=1;return e>l&&(n=l/e),t*n>r&&(n=r/t),{width:e*n,height:t*n,ratio:n}},o=function(e,t){if(this._element=e,t)for(var l=["theme","locale","spacing","yOffset","xOffset","direction","siteName","maxWidth","maxHeight","alignment","useCdn"],r=0;r<l.length;r++){var n=l[r];t.hasOwnProperty(n)&&(this["_"+n]=t[n])}this._initialise()};o.prototype={_element:null,_wrapper:null,_basePath:"/ekmps/images/productbadges/",_locale:"English",_theme:"Rosette/Small",_alt:l,_spacing:2,_yOffset:0,_xOffset:0,_direction:"vertical",_siteName:"",_maxWidth:null,_maxHeight:null,_alignment:"",_useCdn:!1,_initialise:function(){var r=this._element,n=/^2020/.test(this._theme)?e:t,o=this._basePath,f=this._locale,s=this._theme,c=this._spacing,p=this._yOffset,g=this._xOffset,m=this._direction,h=this._siteName,b=this._alignment,$=this._useCdn,v=this,y=this._wrapper=document.createElement("span");y.className="ekm-product-image-badge-wrapper",r.nextSibling?r.parentNode.insertBefore(y,r.nextSibling):r.parentNode.appendChild(y),this._positionWrapper(y,r,!0);var w=p,_=g,k=/\.(?:png|gif|jpg|jpeg)$/i,x=this._maxWidth||r.getAttribute("data-ekm-badges-max-width")||999,A=this._maxHeight||r.getAttribute("data-ekm-badges-max-height")||999;if(null!==r.getAttribute("data-ekm-badges-max-width-orig")||null!==r.getAttribute("data-ekm-badges-max-height-orig")){var N=document.createElement("img");N.src=r.querySelector("img").src;var E,C=Math.min(Math.round(x/N.width),Math.round(A/N.height));w*=C,_*=C,c*=C}(q="IMG"==r.nodeName?r:r.querySelector("img"))||(q=r),x>u(q)/2&&(x=u(q)/2),A>d(q)/2&&(A=d(q)/2);for(var O=_,S=w,B=r.getAttribute("data-ekm-badges")||"",T=(B=B.split(" ")).length,I=c*(T-1),W=0;W<T;W++){var q,P,L,R=B[W];if(/^2020/.test(this._theme)&&t.includes(R)&&(R=R.replace("orange","yellow").replace("pink","red").replace("purple","blue")),this._inArray(n,R))P=o+f+"/"+s+"/"+encodeURIComponent(R)+".png",L=R.substring(R.lastIndexOf("-")+1,R.length)+" "+l;else{if(!k.test(R))continue;P="/ekmps/shops/"+h+"/resources/Design/"+encodeURIComponent(R),$&&(P=`https://files.ekmcdn.com/${h}/resources/design/${encodeURIComponent(R)}`),L=R.substring(0,R.lastIndexOf("."))+" "+l}i(P,L,function(e,t,l,r){var n=x,i=A;"vertical"==m?i=(2*A-I-w)/T:n=(2*x-I-_)/T,({width:l,height:r}=a(l,r,n,i)),({width:l,height:r}=a(l,r,x,A)),l=Math.floor(l),r=Math.floor(r);var o=v._createBadgeElement(e,t,l,r);y.appendChild(o);var f=O,s=S;-1!=b.indexOf("left")&&(f=u(q)-O-l),-1!=b.indexOf("top")&&(s=d(q)-S-r),o.style.bottom=s+"px",o.style.right=f+"px","vertical"==m?S=S+r+c:O=O+l+c})}},_positionWrapper:function(e,t,l){var r=t.getElementsByTagName("img")[0];if(r){if(l){var n=document.createElement("span");n.appendChild(document.createTextNode(".")),e.appendChild(n)}var i=r.getBoundingClientRect(),a=e.getBoundingClientRect(),o=i.right-a.right,f=i.bottom-a.bottom;if(0==i.width){var s=this;r.onload=function(){s._positionWrapper(e,t,!1)}}o=Math.round(100*o)/100,f=Math.round(100*f)/100,e.style.left=o+"px",e.style.top=f+"px"}else{var u=t.getBoundingClientRect();e.style.left=u.width+"px",e.style.top="0px"}},_createBadgeElement:function(e,t,l,r){var n=this._element,i=document.createElement("img");return i.setAttribute("src",e),i.setAttribute("alt",t),i.setAttribute("width",l),i.setAttribute("height",r),i.style.width=`${l}px`,i.style.height=`${r}px`,i.className="ekm-product-image-badge",f(i,"click",function(){n.click()}),i},_inArray:function(e,t){for(var l=e.length-1;l>=0;l--)if(e[l]==t)return!0;return!1}};var f=function(e,t,l){e.addEventListener?e.addEventListener(t,l,!1):e.attachEvent&&e.attachEvent("on"+t,l)},s=function(e,t,l){e.removeEventListener?e.removeEventListener(t,l,!1):e.detachEvent&&e.detachEvent("on"+t,l)},u=function(e){return"IMG"==e.nodeName?e.width:e.clientWidth},d=function(e){return"IMG"==e.nodeName?e.height:e.clientHeight},c=function(e){if(e.childNodes.length>0){for(var t=0,l=e.childNodes.length;t<l;t++)if(1===e.childNodes[t].nodeType)return e.childNodes[t]}for(var r=e.nextSibling;null!==r;){if(1===r.nodeType)return r;r=r.nextSibling}for(var n=e.parentNode;null!==n&&1===n.nodeType;){for(r=n.nextSibling;null!==r;){if(1===r.nodeType)return r;r=r.nextSibling}n=n.parentNode}return null},p=function(e,t){if((t=t||document.documentElement).getElementsByClassName)return[].slice.call(t.getElementsByClassName(e),0);for(var l=[],r=c(t);null!==r&&r!==t.nextSibling;){for(var n=r.className.split(" "),i=0,a=n.length;i<a;i++)if(n[i]===e){l[l.length]=r;break}r=c(r)}return l},g=function(e){for(var t=1,l=arguments.length;t<l;t++){var r=arguments[t];for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e},m=function(e,t,l){l=l||null;for(var r=[].slice.call(e,0),n=0,i=r.length;n<i;n++)t.call(l,r[n],n,r)};f(window,"load",function e(){s(window,"load",e),f(window,"reset",function(e){("ekm-sortby-form"===e.target.className||"ekm-filterby-form"===e.target.className)&&setTimeout(_,100)}),$()});var h={},b=!1,$=function(){b&&y(),b=!0;for(var e="Rose/Small",t=null,l=0,r=0,n=0,i="vertical",a=null,o="",f=!1,s=document.getElementsByTagName("script"),u=0;u<s.length;u++){var d=s[u],c=d.getAttribute("data-ekm-product-badge-style");if(c){e=c,t=d.getAttribute("data-ekm-locale"),l=parseInt(d.getAttribute("data-ekm-product-badge-spacing"),10),r=parseInt(d.getAttribute("data-ekm-product-badge-x"),10),n=parseInt(d.getAttribute("data-ekm-product-badge-y"),10),i=d.getAttribute("data-ekm-product-badge-dir"),a=d.getAttribute("data-ekm-sitename"),o=d.getAttribute("data-ekm-alignment"),f="1"==d.getAttribute("data-ekm-use-cdn");break}}var p=[];!function(){for(var e=document.getElementsByTagName("img"),t=0;t<e.length;t++){for(var l=e[t];9!=l.nodeType&&!l.hasAttribute("data-ekm-badges");)l=l.parentNode;9!=l.nodeType&&l.hasAttribute("data-ekm-badges")&&(p[p.length]=l)}}(),0===p.length&&(p=[].slice.call(document.querySelectorAll("*[data-ekm-badges]")));for(var u=0;u<p.length;u++){var m=g({},h,{theme:e,locale:t,spacing:l,xOffset:r,yOffset:n,direction:i,siteName:a,alignment:o,useCdn:f});v(p[u],m,0)}k()},v=function(e,t,l){for(var r=!0,n=e.getElementsByTagName("img"),i=0;i<n.length;i++)if(!n[i].complete||0===n[i].naturalWidth){r=!1;break}r?new o(e,t):l<10&&setTimeout(function(){v(e,t,l)},250*++l)},y=function(){for(var e=p("ekm-product-image-badge-wrapper"),t=0,l=e.length;t<l;t++){var r=e[t];r.parentNode&&r.parentNode.removeChild(r)}},w=function e(t,l=200){let r;return(...e)=>{clearTimeout(r),r=setTimeout(()=>{t.apply(this,e)},l)}}(function(){n(),$()},600),_=function(e){if(e){n(),$();return}w()},k=function(){var e=null;f(window,"resize",function(t){clearTimeout(e),e=setTimeout(_,250)})},x=function(e,t){for(var l in t)if(t.hasOwnProperty(l)){var r,n="data-ekm-badges-"+(r=l).replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),i=n+"-orig",a=t[l],o=e.getAttribute(i);if(null===o){var f=e.getAttribute(n);e.setAttribute(i,f)}"null"===o&&(o=null),null===a?null!==o?e.setAttribute(n,o):e.removeAttribute(n):e.setAttribute(n,a)}};return{init:$,distroy:y,reInit:_,hasInitialised:function(){return b},setOptions:function(e){g(h,e)},setScopedOptions:function(e,t){document.querySelectorAll&&m(document.querySelectorAll(e),function(e){m(e.querySelectorAll("*[data-ekm-badges]"),function(e){x(e,t)})})}}}();