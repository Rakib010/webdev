var EkmProductImageCarousel=function(){let t="base",e="none",i="panning",n="zoom",a="hover",s="idle";var o,r,h,l=function(t){var e,i=t.constructor||function(){},n={};if(t.extends){var a=t.extends,s=i;i=function(){a.apply(this,arguments),s.apply(this,arguments)};var o=function(){};o.prototype=a.prototype,n=new o}var r={};for(var h in t)if(t.hasOwnProperty(h)){if("constructor"===h||"extends"===h)continue;if("get__"===h.slice(0,5)){r[e=h.slice(5)]=r[e]||{},r[e].getter=t[h];continue}if("set__"===h.slice(0,5)){r[e=h.slice(5)]=r[e]||{},r[e].setter=t[h];continue}if("static__"===h.slice(0,8)){i[e=h.slice(8)]=t[h];continue}n[h]=t[h]}for(var h in r)if(r.hasOwnProperty(h)){var l={enumerable:!0,configurable:!0};r[h].getter&&(l.get=r[h].getter),r[h].setter&&(l.set=r[h].setter),Object.defineProperty(n,h,l)}return i.prototype=n,i};function c(t,e,i){var n,a,s,o=0,r=function(){o++,a=e||this,s=arguments,i&&(n=setTimeout(r.settle,i))};return r.settle=function(){clearTimeout(n),o>0&&t.apply(a,s),o=0},r}function d(t,e){return(t%e+e)%e}function u(t,e,i){return t<e?e:t>i?i:t}function m(t,e,i){e=e||{},i=i||[];var n=document.createElementNS("http://www.w3.org/2000/svg",t);for(var a in e)e.hasOwnProperty(a)&&n.setAttribute(a,e[a]);for(var s=0,o=i.length;s<o;s++)n.appendChild(i[s]);return n}function p(t,e){return e.map(function(e){return t.indexOf(e.originalElement)})}var g=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,40)},f=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelRequestAnimationFrame||function(t){clearTimeout(t)},E=new l({constructor:function(t,e,i,n){this._duration=t,this._startValue=e,this._endValue=i,this._callbacks=n,this._startTime=null,this._stopped=!1,this._requestId=null},start:function(){this._startTime=+new Date,this._stopped=!1,this._requestId=g(this._tick.bind(this))},stop:function(){this._stopped=!0,null!==this._requestId&&(f(this._requestId),this._requestId=null)},_tick:function(){if(!this._stopped){var t=this._duration,e=this._startTime,i=this._startValue,n=this._endValue,a=(+new Date-e)/t,s=(n-i)*(a=Math.min(1,a))+i;this._callbacks.tick&&this._callbacks.tick(s,a),1===a&&(this._stopped=!0),this._stopped?(this._requestId=null,this._callbacks.complete&&this._callbacks.complete(s,a)):this._requestId=g(this._tick.bind(this))}}}),v=new l({constructor:function(t,e){this._state=t,this._reducer=e,this._listeners=[],this._dispatching=!1,this._dispatchQueue=[]},getState:function(){return this._state},dispatch:function(t){if(this._dispatchQueue.push(t),!this._dispatching){for(this._dispatching=!0;e=this._dispatchQueue.shift();){var e,i=this._state=this._reducer(e,this._state);this._listeners.forEach(function(t){t(i)})}this._dispatching=!1}},subscribe:function(t){this._listeners[this._listeners.length]=t},unsubscribe:function(t){this._listeners=this._listeners.filter(function(e){return e!==t})}});function A(t){return t.map(function(t){return F(t.id)}).filter(function(t,e,i){return i.indexOf(t)===e})}function $(t,e){e=!1!==e;var i=new Map,n=A(t);return t.forEach(function(t,a){var s=parseInt(e&&t.getAttribute("data-pic-thumb-id")||n.indexOf(F(t.id)),10);i.set(a,s)}),i}function b(t){var e=t.panSlide+t.panOffset;t.panSlide=d(Math.round(e),t.imageData.length),t.panOffset=d(e+.5,1)-.5}var T=new l({constructor:function(t,e){this._store=t,this._element=e,e.getBoundingClientRect(),this._x=0,this._y=0,this._width=0,this._height=0,this._badgeX=0,this._badgeY=0,this._badgeWidth=0,this._badgeHeight=0,this._badgeImgLength=0,setInterval(this._check.bind(this),750),window.addEventListener("resize",this._check.bind(this)),this._mo=new MutationObserver(this._onMutation.bind(this)),this._mo.observe(e,{childList:!0,subtree:!0}),window.IntersectionObserver&&(this._io=new IntersectionObserver(this._onIntersection.bind(this),{threshold:[0,1]}),this._io.observe(e),this._isIntersecting=null)},_check:function(){var t=this._element.getBoundingClientRect(),e=t.left+window.pageXOffset,i=t.top+window.pageYOffset,n=t.right-t.left,a=t.bottom-t.top;(this._x!==e||this._y!==i||this._width!==n||this._height!==a)&&(this._x=e,this._y=i,this._width=n,this._height=a,this._store.dispatch({type:"TRACKED_ELEMENT_CHANGE",x:e,y:i,width:n,height:a}));var s=this._element.querySelector(".ekm-product-image-badge-wrapper");s&&this._checkBadges(s)},_checkBadges:function(t){var e=z(t.querySelectorAll("img")),i=t.getBoundingClientRect(),n={x:i.left+window.pageXOffset,y:i.top+window.pageYOffset,width:i.right-i.left,height:i.bottom-i.top},e=e.map(function(t){return{src:t.src,width:t.getAttribute("width"),height:t.getAttribute("height"),top:t.style.top,left:t.style.left,bottom:t.style.bottom,right:t.style.right}});(this._badgeX!==n.x||this._badgeY!==n.y||this._badgeWidth!==n.width||this._badgeHeight!==n.height||this._badgeImgLength!==e.length)&&(this._badgeX=n.x,this._badgeY=n.y,this._badgeWidth=n.width,this._badgeHeight=n.height,this._badgeImgLength=e.length,this._store.dispatch({type:"BADGE_CHANGED",wrapperRect:n,badges:e}))},_onMutation:function(t){var e="ekm-product-image-badge-wrapper";t.forEach(function(t){if(t.target.classList.contains(e))(t.addedNodes.length||t.removedNodes.length)&&this._checkBadges(t.target);else if(t.removedNodes.length){var i=function(t){return t.classList.contains(e)};z(t.removedNodes).some(i)&&(this._badgeX=0,this._badgeY=0,this._badgeWidth=0,this._badgeHeight=0,this._badgeImgLength=0,this._store.dispatch({type:"BADGE_CHANGED",wrapperRect:{x:0,y:0,width:0,height:0},badges:[]}))}},this)},_onIntersection:function(t,e){t.forEach(function(t){this._store.getState().isIntersecting!==t.isIntersecting&&this._store.dispatch({type:"INTERSECTION_CHANGE",isIntersecting:t.isIntersecting})},this)}}),w=new l({constructor:function(t){for(var e in this._values={},this._listeners={},t)t.hasOwnProperty(e)&&this.subscribe(e,t[e])},subscribe:function(t,e){var i=this._listeners[t]=this._listeners[t]||[];i[i.length]=e},check:function(t){var e=this._listeners;for(var i in e)if(e.hasOwnProperty(i)&&this._values[i]!==t[i]){var n=this._values[i]=t[i];e[i].forEach(function(t){t(i,n)})}}}),y=new l({constructor:function(t){this._store=t,this._state=null,this._element=document.createElement("div"),this._element.classList.add("ekm-pic-panviewport"),this._primaryImageParent=U(),this._onImageDataChange=c(function(){this._updateBackground()},this),this._onResize=c(function(){this._updateBackground(),this._updatePan()},this),this._onPan=c(function(){this._updatePan()},this),this._onIsUpdateingImageDataChange=c(function(){this._state.isUpdateingImageData&&this._setTempPanImage()},this),this._onAnimationModeChange=c(function(){this._updateVisibility()},this),this._pcc=new w({imageData:this._onImageDataChange,trackedElementWidth:this._onResize,trackedElementHeight:this._onResize,panSlide:this._onPan,panOffset:this._onPan,isUpdateingImageData:this._onIsUpdateingImageDataChange,animationMode:this._onAnimationModeChange})},toElement:function(){return this._element},update:function(t){this._state=t,this._pcc.check(t),this._onImageDataChange.settle(),this._onResize.settle(),this._onPan.settle(),this._onIsUpdateingImageDataChange.settle(),this._onAnimationModeChange.settle()},_setTempPanImage:function(){this._primaryImageParent&&(this._primaryImageParent.style.opacity=1,this._element.style.visibility="hidden")},_removeTempPanImage:function(){var t=this._primaryImageParent;if(t&&!this._state.isUpdateingImageData){this._element.style.visibility="visible";var e=parseFloat(getComputedStyle(t).opacity);0!==e&&(this._tween&&this._tween.stop(),this._tween=new E(200*e,e,0,{tick:function(e){t.style.opacity=e},complete:function(){t.style.opacity=0}}),this._tween.start())}},_updateBackground:function(){if(this._state){var t=this._state.imageData,e=t.map(function(t){return t.full}),i={allowUpscaling:this._state.allowUpscaling,frameWidth:this._state.trackedElementWidth,frameHeight:this._state.trackedElementHeight,videos:this._state.imageData.map(function(t){return t.isVideo})};this._cancelMakePanImage&&this._cancelMakePanImage(),this._cancelMakePanImage=function t(e,i,n){var a,s=!1,o=function(){s=!0};return a=function(a){if(!s){var r=window.devicePixelRatio||1;r=(N()?sessionStorage.getItem("_ekm_mobile_safari_memory_leak_workaround_ratio"):null)||i.devicePixelRatio||2;var h=i.frameWidth||0,l=i.frameHeight||0;if(0!==h&&0!==l){h*=r,l*=r;var c,d=h*e.length,u=e.map(function(t,e){var n=(h-2)/t.width;if(t.height*n>l&&(n=l/t.height),!i.allowUpscaling){let s=r;n>s&&(n=s)}var o=t.width*n,c=t.height*n,d=(h-o)/2,u=(l-c)/2,m=[];if(i.videos[e]&&null!==a){var p,g,f,E,v=(p={width:a.width,height:a.height},f=(g={width:o,height:c}).width/p.width,p.height*f>g.height&&(f=g.height/p.height),{dw:E=p.width*f,dh:p.height*f});v.img=a.img,m.push(v)}return{dw:o,dh:c,dx:d,dy:u,img:t.img,overlays:m}}),m=document.createElement("canvas");m.width=Math.floor(d),m.height=Math.floor(l),c=r,N()&&sessionStorage.setItem("_ekm_mobile_safari_memory_leak_workaround_ratio",c);var p=m.getContext("webgl",{premultiplyAlpha:!1});N()&&sessionStorage.removeItem("_ekm_mobile_safari_memory_leak_workaround_ratio");var g=Math.floor(p.drawingBufferWidth);if(g<Math.floor(d)){try{p.getExtension("WEBGL_lose_context").loseContext()}catch(f){}m=p=null;var E=g/d*r;o=t(e,{...i,devicePixelRatio:E},n);return}var v=p.createShader(p.VERTEX_SHADER),A=p.createShader(p.FRAGMENT_SHADER);p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),p.enable(p.BLEND),p.blendFunc(p.ONE,p.ONE_MINUS_SRC_ALPHA),p.shaderSource(v,"attribute vec2 a_position;uniform vec2 u_resolution;uniform mat3 u_matrix;varying vec2 v_texCoord;void main() {	gl_Position = vec4(u_matrix * vec3(a_position, 1), 1);	v_texCoord = a_position;}"),p.shaderSource(A,"precision mediump float;uniform sampler2D u_image;varying vec2 v_texCoord;void main() {	gl_FragColor = texture2D(u_image, v_texCoord);   gl_FragColor.rgb *= gl_FragColor.a;}"),p.compileShader(v),p.compileShader(A);var $=p.createProgram();p.attachShader($,v),p.attachShader($,A),p.linkProgram($),p.useProgram($);var b=p.getAttribLocation($,"a_position"),T=p.getUniformLocation($,"u_matrix"),w=p.createBuffer();p.bindBuffer(p.ARRAY_BUFFER,w),p.bufferData(p.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),p.STATIC_DRAW),p.enableVertexAttribArray(b),p.vertexAttribPointer(b,2,p.FLOAT,!1,0,0);var y="";if(u.forEach(function(t,e){H(p,t,offset=h*e,h,l,T),t.overlays.forEach(function(t){H(p,t,offset,h,l,T)}),y+=t.img.src}),"function"==typeof m.msToBlob){var x=m.msToBlob(),I=URL.createObjectURL(x);try{p.getExtension("WEBGL_lose_context").loseContext()}catch(S){}m=p=null,n({dataUrl:I,imgSrcs:y,frameWidth:i.frameWidth,frameHeight:i.frameHeight,data:u.map(function(t){return{x:t.dx,y:t.dy,width:t.dw,height:t.dh,pixelRatio:r}})})}else(!function t(){let e=navigator.userAgent;return/Android[ \.0-9]*; (?:SAMSUNG|SM-)/.test(e)}()?m:function t(e){let i=new Uint8Array(e.drawingBufferWidth*e.drawingBufferHeight*4);e.readPixels(0,0,e.drawingBufferWidth,e.drawingBufferHeight,e.RGBA,e.UNSIGNED_BYTE,i);let n=new Uint8Array(e.drawingBufferWidth*e.drawingBufferHeight*4),a=4*e.drawingBufferWidth,s=i.length/a;for(let o=0;o<s;o++)for(let r=0;r<a;r++){let h=s-o,l=(h-1)*a+r,c=o*a+r;n[l]=i[c]}let d=document.createElement("canvas");d.width=e.drawingBufferWidth,d.height=e.drawingBufferHeight;let u=d.getContext("2d");var m=u.createImageData(d.width,d.height);return m.data.set(n),u.putImageData(m,0,0),d}(p)).toBlob(function(t){try{p.getExtension("WEBGL_lose_context").loseContext()}catch(e){}m=p=null,!s&&n({dataUrl:URL.createObjectURL(t),imgSrcs:y,frameWidth:i.frameWidth,frameHeight:i.frameHeight,data:u.map(function(t){return{x:t.dx,y:t.dy,width:t.dw,height:t.dh,pixelRatio:r}})})})}}},new Promise(t=>{var e=new Image;e.src="/ekmps/assets/images/edititem/play-circle.png",e.onload=function(){t({img:e,width:e.naturalWidth||e.width,height:e.naturalHeight||e.height})},e.onerror=function(){t(null)},setTimeout(function(){t(null)},25e3)}).then(a),function(){o()}}(e,i,(function(e){e.frameWidth===this._state.trackedElementWidth&&e.frameHeight===this._state.trackedElementHeight&&t===this._state.imageData&&(this._state.panImageSrcs!==e.imgSrcs||this._state.panImageWidth!==e.frameWidth||this._state.panImageHeight!==e.frameHeight?(this._element.style.backgroundImage="url("+e.dataUrl+")",this._element.style.backgroundSize=100*e.data.length+"% 100%",this._removeTempPanImage(),this._store.dispatch({type:"PAN_IMAGE_DATA_UPDATED",data:e.data,url:e.dataUrl,imgSrcs:e.imgSrcs,frameWidth:e.frameWidth,frameHeight:e.frameHeight})):this._removeTempPanImage())}).bind(this))}},_updatePan:function(){var t=this._state.trackedElementWidth,e=this._state.panSlide,i=this._state.panOffset;this._element.style.backgroundPositionX=-(t*e)-t*i+"px"},_updateVisibility:function(){this._state.animationMode==s?this._element.style.opacity=1:this._element.style.opacity=0}}),x=new l({constructor:function(){this._state=null,this._element=document.createElement("div"),this._element.classList.add("ekm-pic-zoomglass"),this._offsetX=50,this._offsetY=50;var t="ekmpic"+ +new Date;this._focusElement=m("rect",{x:"0",y:"0",width:"100",height:"100",fill:"black",stroke:"white","stroke-width":"1"}),this._colourElement=m("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"rgba(255, 255, 255, 0.75)",mask:"url(#"+t+")"}),this._svgElement=m("svg",{width:"100%",height:"100%"},[m("mask",{id:t},[m("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"grey"}),this._focusElement]),this._colourElement]),this._element.appendChild(this._svgElement),this._onFocusChange=c(function(){this._updateFocus()},this),this._onResize=c(function(){this._updateSize(),this._updateFocusSize()},this),this._pcc=new w({zoomFocusX:this._onFocusChange,zoomFocusY:this._onFocusChange,trackedElementWidth:this._onResize,trackedElementHeight:this._onResize,panSlide:this._updateFocusSize.bind(this),zoomAlpha:this._updateAlpha.bind(this)})},toElement:function(){return this._element},update:function(t){this._state=t,this._pcc.check(t),this._onFocusChange.settle(),this._onResize.settle()},_updateFocus:function(){var t=this._state,e=t.trackedElementWidth*t.zoomFocusX-this._offsetX,i=t.trackedElementHeight*t.zoomFocusY-this._offsetY,n=t.panImageData[t.panSlide];e=u(e,(n=n||{x:0,y:0,width:t.trackedElementWidth,height:t.trackedElementHeight,pixelRatio:1}).x/n.pixelRatio,n.x/n.pixelRatio+n.width/n.pixelRatio-2*this._offsetX),i=u(i,n.y/n.pixelRatio,n.y/n.pixelRatio+n.height/n.pixelRatio-2*this._offsetY),this._focusElement.setAttribute("x",e),this._focusElement.setAttribute("y",i),this._colourElement.setAttribute("x",n.x/n.pixelRatio),this._colourElement.setAttribute("y",n.y/n.pixelRatio),this._colourElement.setAttribute("width",n.width/n.pixelRatio),this._colourElement.setAttribute("height",n.height/n.pixelRatio)},_updateSize:function(){this._svgElement.setAttribute("width",this._state.trackedElementWidth),this._svgElement.setAttribute("height",this._state.trackedElementHeight)},_updateFocusSize:function(){var t=this._state,e=t.panImageData[t.panSlide];e=e||{x:0,y:0,width:t.trackedElementWidth,height:t.trackedElementHeight,pixelRatio:1};var i=t.imageData[t.panSlide].full,n=e.width/e.pixelRatio/i.width,a=t.trackedElementWidth*n,s=t.trackedElementHeight*n;this._focusElement.setAttribute("width",a),this._focusElement.setAttribute("height",s),this._offsetX=a/2,this._offsetY=s/2},_updateAlpha:function(){this._element.style.opacity=this._state.zoomAlpha}}),I=new l({constructor:function(){},toElement:function(){return document.createDocumentFragment()},update:function(t){}}),S=new l({constructor:function(t){this._store=t,this._state=null,this._element=document.createElement("div"),this._element.classList.add("ekm-pic-animationviewport"),this._addAnimationTimeoutId=null,this._onChange=c(function(){this._updateAnimation()},this),this._pcc=new w({interactionContext:this._onChange,panSlide:this._onChange,imageData:this._onChange,panImageData:this._onChange})},toElement:function(){return this._element},update:function(t){this._state=t,this._pcc.check(t),this._onChange.settle()},_updateAnimation:function(){if(this._state.interactionContext!==t){this._removeAnimation();return}var e=this._state.imageData[this._state.panSlide];if(!e.isAnimated){this._removeAnimation();return}this._addAnimation(e.full.img)},_addAnimation:function(t){clearTimeout(this._addAnimationTimeoutId),this._addAnimationTimeoutId=setTimeout(()=>{var e=this._state.panImageData[this._state.panSlide];if(e){var{width:i,pixelRatio:n}=e,a=t.cloneNode();for(a.style.width=`${i/n}px`;this._element.firstChild;)this._element.removeChild(this._element.firstChild);this._element.appendChild(a),this._store.dispatch({type:"UPDATE_ANIMATION_MODE",mode:"playing"})}},750)},_removeAnimation:function(){for(clearTimeout(this._addAnimationTimeoutId);this._element.firstChild;)this._element.removeChild(this._element.firstChild);this._store.dispatch({type:"UPDATE_ANIMATION_MODE",mode:s})}}),k=new l({constructor:function(){this._state=null,this._element=document.createElement("div"),this._element.classList.add("ekm-pic-zoomviewport"),this._onSlideChange=c(function(){this._updateSilde()},this),this._onFocus=c(function(){this._updateFocusPosition(),this._updateFocusPosition()},this),this._onPositionChange=c(function(){this._updatePosition()},this),this._pcc=new w({imageData:this._onSlideChange,zoomSlide:this._onSlideChange,zoomAlpha:this._updateAlpha.bind(this),zoomFocusX:this._onFocus,zoomFocusY:this._onFocus,zoomOrigin:this._onPositionChange,zoomOffsetX:this._onPositionChange,zoomOffsetY:this._onPositionChange,trackedElementX:this._onPositionChange,trackedElementY:this._onPositionChange,trackedElementWidth:this._onPositionChange,trackedElementHeight:this._onPositionChange})},toElement:function(){return this._element},update:function(t){this._state=t,this._pcc.check(t),this._onSlideChange.settle(),this._onFocus.settle(),this._onPositionChange.settle()},_updateSilde:function(){var t=this._state,e=t.imageData[t.zoomSlide].full.src;this._element.style.backgroundImage="url("+CSS.escape(e)+")"},_updateAlpha:function(){this._element.style.opacity=this._state.zoomAlpha,this._element.style.display=0===this._state.zoomAlpha?"none":""},_updateFocusPosition:function(){var t=this._state;if("center"===t.zoomOrigin&&0===t.zoomOffsetX&&0===t.zoomOffsetY){var e=u(120*t.zoomFocusX-10,0,100),i=u(120*t.zoomFocusY-10,0,100);this._element.style.backgroundPositionX=e+"%",this._element.style.backgroundPositionY=i+"%";return}var n=t.imageData[t.panSlide].full.width,a=t.imageData[t.panSlide].full.height,s=(t.trackedElementWidth-2)/n;a*s>t.trackedElementHeight&&(s=t.trackedElementHeight/a);var o=(t.trackedElementWidth-n*s)/2,r=(t.trackedElementHeight-a*s)/2,h=t.trackedElementWidth/s,l=t.trackedElementHeight/s,c=h*t.zoomFocusX,d=l*t.zoomFocusY,m=c-t.trackedElementWidth/2,p=d-t.trackedElementHeight/2;m-=o/s,p-=r/s,m=u(-m,-(n-t.trackedElementWidth),0),p=u(-p,-(a-t.trackedElementHeight),0),this._element.style.backgroundPositionX=m+"px",this._element.style.backgroundPositionY=p+"px"},_updatePosition:function(){var t=this._state,e=0,i=0;"left"===t.zoomOrigin&&(e=-t.trackedElementWidth),"right"===t.zoomOrigin&&(e=t.trackedElementWidth),e+=t.zoomOffsetX,i+=t.zoomOffsetY,this._element.style.left=e+"px",this._element.style.top=i+"px"}}),P=new l({constructor:function(t){this._store=t,t.subscribe(this._onUpdate.bind(this)),this._element=document.createElement("div"),this._element.classList.add("ekm-pic-eventmask"),t.getState().useZoom&&this._element.classList.add("ekm-pic-zoomable"),this._pcc=new w({interactionContext:this._onInteractionContextChange.bind(this)}),this._interactionContext=t.getState().interactionContext,this._expectingMouseUp=!1,this._expectingMouseMove=!1,this._expectingShortPress=!1,this._expectingTouchEnd=!1,this._expectingTouchMove=!1,this._originX=0,this._originY=0,this._originPageX=0,this._originPageY=0,this._longPressTimoutId=null,this._scrollY=window.pageYOffset,this._useZoomHoverTrigger=t.getState().useZoomHoverTrigger,this._waitForZoomHover=!1,this._zoomHoverTimeoutId=null,this._queueZoomHoverOnContextChange=!1,document.addEventListener("mousedown",this._onMouseDown.bind(this)),document.addEventListener("mouseup",this._onMouseUp.bind(this)),document.addEventListener("mousemove",this._onMouseMove.bind(this)),this._element.addEventListener("mouseenter",this._onMouseEnter.bind(this)),this._element.addEventListener("mouseleave",this._onMouseLeave.bind(this)),document.addEventListener("touchstart",this._onTouchStart.bind(this),{passive:!1}),document.addEventListener("touchend",this._onTouchEnd.bind(this),{passive:!1}),document.addEventListener("touchcancel",this._onTouchEnd.bind(this),{passive:!1}),document.addEventListener("touchmove",this._onTouchMove.bind(this),{passive:!1}),window.addEventListener("scroll",this._onScroll.bind(this))},toElement:function(){return this._element},_onUpdate:function(t){this._interactionContext=t.interactionContext,this._pcc.check(t)},_onMouseDown:function(t){t.target===this._element&&(this._expectingMouseUp||(t.preventDefault(),clearTimeout(this._zoomHoverTimeoutId),this._waitForZoomHover=!1,this._expectingMouseUp=!0,this._expectingMouseMove=!0,this._expectingShortPress=!0,this._originX=t.screenX,this._originY=t.screenY,this._originPageX=t.pageX,this._originPageY=t.pageY,this._store.dispatch({type:"INTERACTION_START"}),this._longPressTimoutId=setTimeout(this._onLongPress.bind(this),750)))},_onMouseUp:function(e){this._expectingMouseUp&&(e.preventDefault(),clearTimeout(this._longPressTimoutId),this._expectingMouseUp=!1,this._expectingMouseMove=!1,this._interactionContext===i&&this._store.dispatch({type:"PAN_SETTLE"}),this._interactionContext===n&&this._store.dispatch({type:"ZOOM_STOP"}),this._expectingShortPress&&this._interactionContext===t&&0===e.button&&this._store.dispatch({type:"OPEN_IMAGE"}))},_onMouseMove:function(e){if(this._waitForZoomHover&&(this._originX=e.screenX,this._originY=e.screenY,this._originPageX=e.pageX,this._originPageY=e.pageY),this._expectingMouseMove){e.preventDefault(),this._expectingShortPress=!1;var a=this._interactionContext,s=Math.abs(e.screenX-this._originX);if(s>50&&clearTimeout(this._longPressTimoutId),a===i||a===t&&s>50){this._store.dispatch({type:"PAN_UPDATE",x:-(e.screenX-this._originX)});return}if(a===n){var o=this._store.getState();this._store.dispatch({type:"ZOOM_UPDATE",x:e.pageX-o.trackedElementX,y:e.pageY-o.trackedElementY})}}},_onMouseEnter:function(){if(this._isMouseOverElement=!0,this._useZoomHoverTrigger){var n=this._interactionContext;(n===e||n===i)&&(this._queueZoomHoverOnContextChange=!0),n===t&&(this._waitForZoomHover=!0,this._zoomHoverTimeoutId=setTimeout(this._onZoomHover.bind(this),750))}},_onMouseLeave:function(){if(this._isMouseOverElement=!1,this._useZoomHoverTrigger)this._waitForZoomHover&&(this._waitForZoomHover=!1,clearTimeout(this._zoomHoverTimeoutId)),this._queueZoomHoverOnContextChange=!1,this._interactionContext===n&&this._store.getState().zoomTigger===a&&(this._expectingMouseUp=!1,this._expectingMouseMove=!1,this._store.dispatch({type:"ZOOM_STOP"}))},_onTouchStart:function(t){if(t.target===this._element&&!(t.touches.length>1)){this._expectingTouchEnd=!0,this._expectingTouchMove=!0,this._expectingShortPress=!0;var e=t.touches[0],i=Math.max(e.radiusX||0,e.radiusy||0);this._originX=e.screenX,this._originY=e.screenY-i,this._originPageX=e.pageX,this._originPageY=e.pageY-i,this._store.dispatch({type:"INTERACTION_START"}),this._longPressTimoutId=setTimeout(this._onLongPress.bind(this),750)}},_onTouchEnd:function(e){this._expectingTouchEnd&&(clearTimeout(this._longPressTimoutId),this._expectingTouchEnd=!1,this._expectingTouchMove=!1,this._interactionContext===i&&this._store.dispatch({type:"PAN_SETTLE"}),this._interactionContext===n&&this._store.dispatch({type:"ZOOM_STOP"}),this._expectingShortPress&&this._interactionContext===t&&(e.preventDefault(),this._store.dispatch({type:"OPEN_IMAGE"})))},_onTouchMove:function(e){if(this._expectingTouchMove&&!(e.touches.length>1)){this._expectingShortPress=!1;var a=e.touches[0],s=Math.max(a.radiusX||0,a.radiusy||0),o=a.screenX;a.screenY;var r=a.pageX,h=a.pageY-s,l=this._interactionContext,c=Math.abs(o-this._originX);if(c>50&&clearTimeout(this._longPressTimoutId),l===i||l===t&&c>50){e.preventDefault(),this._store.dispatch({type:"PAN_UPDATE",x:-(o-this._originX)});return}if(l===n){e.preventDefault();var d=this._store.getState();this._store.dispatch({type:"ZOOM_UPDATE",x:r-d.trackedElementX,y:h-d.trackedElementY})}}},_onScroll:function(){this._expectingTouchMove?Math.abs(this._scrollY-window.pageYOffset)>25&&(clearTimeout(this._longPressTimoutId),this._interactionContext!==n&&(this._expectingTouchMove=!1),this._interactionContext===i&&this._store.dispatch({type:"PAN_CANCEL"})):this._scrollY=window.pageYOffset},_onLongPress:function(){var t=this._store.getState();this._expectingShortPress=!1,this._store.dispatch({type:"ZOOM_START",x:this._originPageX-t.trackedElementX,y:this._originPageY-t.trackedElementY,trigger:"long_press"})},_onInteractionContextChange:function(){var a=this._interactionContext,s=this._element;s.classList.remove("ekm-pic-panning"),s.classList.remove("ekm-pic-zooming"),a===i&&s.classList.add("ekm-pic-panning"),a===n&&(s.classList.add("ekm-pic-zooming"),this._expectingMouseMove=!0),this._useZoomHoverTrigger&&(this._queueZoomHoverOnContextChange&&a===t?(this._queueZoomHoverOnContextChange=!1,this._waitForZoomHover=!0,this._zoomHoverTimeoutId=setTimeout(this._onZoomHover.bind(this),750)):(a===e&&this._isMouseOverElement&&(this._queueZoomHoverOnContextChange=!0),clearTimeout(this._zoomHoverTimeoutId),this._waitForZoomHover=!1))},_onZoomHover:function(){if(this._waitForZoomHover){var t=this._store.getState();this._waitForZoomHover=!1,this._expectingShortPress=!1,this._store.dispatch({type:"ZOOM_START",x:this._originPageX-t.trackedElementX,y:this._originPageY-t.trackedElementY,trigger:a})}}}),C=new l({constructor:function(){this._state=null,this._element=document.createElement("div"),this._element.classList.add("ekm-pic-badges"),this._onUpdateWrapper=c(function(){this._updateWrapper()},this),this._pcc=new w({zoomAlpha:this._updateAlpha.bind(this),badges:this._updateBadges.bind(this),badgeWrapperX:this._onUpdateWrapper,trackedElementX:this._onUpdateWrapper,badgeWrapperY:this._onUpdateWrapper,trackedElementY:this._onUpdateWrapper,badgeWrapperWidth:this._onUpdateWrapper,badgeWrapperHeight:this._onUpdateWrapper})},toElement:function(){return this._element},update:function(t){this._state=t,this._pcc.check(t),this._onUpdateWrapper.settle()},_updateAlpha:function(){this._element.style.opacity=1-this._state.zoomAlpha},_updateWrapper:function(){var t=this._element.querySelector(".ekm-product-image-badge-wrapper");if(t){var e=this._state;t.style.position="absolute",t.style.left=e.badgeWrapperX-e.trackedElementX+"px",t.style.top=e.badgeWrapperY-e.trackedElementY+"px",t.style.width=e.badgeWrapperWidth+"px",t.style.height=e.badgeWrapperHeight+"px"}},_updateBadges:function(){for(;this._element.firstChild;)this._element.removeChild(this._element.firstChild);if(0!==this._state.badges.length){var t=this._state,e=document.createElement("span");e.classList.add("ekm-product-image-badge-wrapper"),t.badges.forEach(function(t){var i=document.createElement("img");i.src=t.src,t.width&&(i.setAttribute("width",t.width),i.style.width=`${t.width}px`),t.height&&(i.setAttribute("height",t.height),i.style.height=`${t.height}px`),(null!==t.top||void 0!==t.top)&&(i.style.top=t.top),(null!==t.left||void 0!==t.left)&&(i.style.left=t.left),(null!==t.bottom||void 0!==t.bottom)&&(i.style.bottom=t.bottom),(null!==t.right||void 0!==t.right)&&(i.style.right=t.right),e.appendChild(i)}),this._element.appendChild(e),this._updateWrapper()}}}),O=new l({constructor:function(t){this._store=t;var e=t.getState();t.subscribe(this._onUpdate.bind(this)),this._panViewport=new y(t),this._zoomGlass=e.useZoomGlass?new x:new I,this._productBadges=new C,this._animationViewPort=new S(t),this._zoomViewport=new k,this._eventMask=new P(t),this._element=document.createElement("div"),this._element.classList.add("ekm-pic-root"),this._element.style.width="532.41px",this._element.style.height="532.41px",this._element.appendChild(this._panViewport.toElement()),this._element.appendChild(this._zoomGlass.toElement()),this._element.appendChild(this._productBadges.toElement()),this._element.appendChild(this._animationViewPort.toElement()),this._element.appendChild(this._zoomViewport.toElement()),this._element.appendChild(this._eventMask.toElement()),this._pcc=new w({trackedElementX:(function(t,e){e=this._adjustValueRelativeToBody(e,"x"),this._element.style.left=e+"px"}).bind(this),trackedElementY:(function(t,e){e=this._adjustValueRelativeToBody(e,"y"),this._element.style.top=e+"px"}).bind(this),trackedElementWidth:(function(t,e){this._element.style.width=e+"px"}).bind(this),trackedElementHeight:(function(t,e){this._element.style.height=e+"px"}).bind(this)})},_adjustValueRelativeToBody:function(t,e){if("static"===getComputedStyle(document.body).position)return t;var i=document.body.getBoundingClientRect();return"x"===e?t-(i.left+window.pageXOffset):t-(i.top+window.pageYOffset)},_onUpdate:function(t){this._pcc.check(t),this._panViewport.update(t),this._zoomGlass.update(t),this._productBadges.update(t),this._animationViewPort.update(t),this._zoomViewport.update(t)},toElement:function(){return this._element}}),D=new l({constructor:function(t,e,i,n,a,s){this.small=t,this.large=e,this.full=i,this.originalElement=a,this.isVideo=null!==n,this.videoData=n,this.isAnimated=s},static__create:function(t,e,i,n,a,s){var o,r,h,l=0,c=function(){var t;(t=i,new Promise(e=>/\.avif/i.test(t)?e(!0):/\.gif/i.test(t)||/\.apng/i.test(t)||/\.webp/i.test(t)?void fetch(t,{method:"GET",mode:"cors",credentials:"omit"}).then(t=>t.blob()).then(t=>new Promise(e=>{var i=new FileReader;i.addEventListener("load",t=>{e(t.target.result)}),i.readAsArrayBuffer(t)})).then(t=>new Uint8Array(t)).then(t=>{var i,n,a,s,o=new TextDecoder().decode(t);i=o,n=i.indexOf("IDAT"),a=i.indexOf("acTL"),-1!=n&&a<n&&e(!0),s=o,-1!=s.indexOf("ANMF")&&e(!0),function t(e){if("GIF"!==new TextDecoder().decode(e.slice(0,3)))return!1;for(var i=0,n=5,a=e.length-3;n<a;n++)if(0==e[n]&&33==e[n+1]&&249==e[n+2]&&++i>1)return!0;return!1}(t)&&e(!0),e(!1)}):e(!1))).then(t=>{s(new D(o,r,h,n,a,t))})};M.create(t,function(t){o=t,3==++l&&c()}),M.create(e,function(t){r=t,3==++l&&c()}),M.create(i,function(t){h=t,3==++l&&c()})}}),M=new l({constructor:function(t,e,i,n){this.src=t,this.width=e,this.height=i,this.img=n},static__create:function(t,e){e=(i=e,n=!1,function(){if(!n)return n=!0,i.apply(this,arguments)});var i,n,a=document.createElement("img");a.crossOrigin=!0,a.src=t,a.onload=function(){e(new M(t,a.naturalWidth||a.width,a.naturalHeight||a.height,a))},a.onerror=function(){e(null)},setTimeout(function(){e(null)},25e3)}}),_=new l({constructor:function(t,e){this._store=t,this._bullets=e.bullets,this._activeClass=e.bulletActiveClass,this._state=null,this._lastActive=null,this._store.subscribe(this._onUpdate.bind(this)),this._pcc=new w({panSlide:this._updateActive.bind(this),visibleElements:this._updateVisible.bind(this)})},_onUpdate:function(t){this._state=t,this._pcc.check(t)},_updateActive:function(){null!==this._lastActive&&this._bullets[this._lastActive].forEach(function(t){t.classList.remove(this._activeClass)});var t=this._state.visibleElements[this._state.panSlide];this._bullets[t].forEach(function(t){t.classList.remove(this._activeClass)}),this._lastActive=t},_updateVisible:function(){this._bullets.forEach(function(t){t.forEach(function(t){t.style.display="none"})}),this._state.visibleElements.forEach(function(t){this._bullets[t].forEach(function(t){t.style.display=""})},this)}}),L=new l({constructor:function(t){this._store=t,this._state=t.getState(),t.subscribe(this._onUpdate.bind(this)),this._pcc=new w({imageData:this._onImageDataChange.bind(this),elementSlideMap:this._onElementSlideMapChange.bind(this)}),this._slideIndex=0,this._map=this._state.elementSlideMap},_onUpdate:function(t){this._state=t,this._pcc.check(t)},_onElementSlideMapChange:function(){var t=this._state;t.elementSlideMap.forEach(function(e,i){if(0!==i&&t.imageData[i]&&t.imageData[e]){var n=t.imageData[i].originalElement,a=t.imageData[e],s=null==a.videoData?"":JSON.stringify(a.videoData),o=A(t.elements).indexOf(F(a.originalElement.id)),r=n.querySelector("img");n.setAttribute("data-video",s),n.setAttribute("data-pic-thumb-id",o),r.setAttribute("data-pic-thumb-id",o),r.src=a.small.src}})},_onImageDataChange:function(){this._state.elements.forEach(function(t){t.removeAttribute("data-pic-thumb-id"),t.querySelector("img").removeAttribute("data-pic-thumb-id")})}});function z(t){return[].slice.call(t)}function R(t,e){var i=[],n=0,a=t.length,s=function(){e(i=i.filter(function(t){return null!==t.full}))};t.forEach(function(t,e){var o=t.getAttribute("data-thumbnailimg"),r=t.getAttribute("data-largeimg"),h=t.getAttribute("href"),l=JSON.parse(t.getAttribute("data-video")||null);if("#"===h&&(h=null),r||(r=h),o||(o=r),null===h){a--;return}D.create(o,r,h,l,t,function(t){i[e]=t,++n===a&&s()})})}function N(){let t=/Safari/.test(navigator.userAgent),e=/Mobile/.test(navigator.userAgent);return t&&e}function H(t,e,i,n,a,s){var o=t.createTexture();t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.img);var r=e.dw,h=e.dh,l=((n-r)/2+i)/t.canvas.width*2-1,c=-((a-h)/2/t.canvas.height*2)+1,d=r/t.canvas.width*2,u=-(h/t.canvas.height*2);t.uniformMatrix3fv(s,!1,[d,0,0,0,u,0,l,c,1,]),t.drawArrays(t.TRIANGLES,0,6)}function U(){for(var{primary:t,fallback:e}of[{primary:"a:not(.js-ignore-carousel) #_EKM_PRODUCTIMAGE_1",fallback:"#_EKM_PRODUCTIMAGE_1"},{primary:'a:not(.js-ignore-carousel) [id^="_EKM_PRODUCTIMAGE_1_"]',fallback:'[id^="_EKM_PRODUCTIMAGE_1_"]'}]){var i=document.querySelector(t);if(null===i){var n=document.querySelector(e);if(null===n)continue;return n.parentNode.parentNode}for(;i.parentNode;){if("A"===i.tagName)return i.parentNode;i=i.parentNode}}return null}function W(t){var e=new Map;return t.forEach(function(t,i){e.set(i,t)}),e}function F(t){return parseInt(/_(\d+)(?:_\d+)?/.exec(t)[1],10)}return h=function(t){if(void 0!==o)throw Error("API store already set.");o=t},r={resetThumbnailOrder:function(){o&&o.dispatch({type:"RESET_THUMBNAIL_ORDER"})}},window.addEventListener("DOMContentLoaded",function a(){var o=z(document.querySelectorAll('[id^="_EKM_PRODUCTIMAGE_LINK_"]:not(.js-ignore-carousel)'));o.sort(function(t,e){return F(t.id)-F(e.id)});var r={elements:o,lightbox:!!(window.ekm&&ekm.$&&ekm.$.fn.lightBox),zoom:!!(window.ekm&&ekm.mousezoomOptions),zoomOptions:window.ekm&&ekm.mousezoomOptions||{},bullets:[],bulletActiveClass:"ekm-pic-active",leftNavigation:null,rightNavigation:null,allowUpscaling:!0};window.mouse_zoom_mobile_check&&(r.zoomOptions.glass=!1,r.zoomOptions.offsetX=0,r.zoomOptions.offsetY=0,r.zoomOptions.position="center"),!1===window.mouse_zoom_mobile_check&&r.zoom&&(r.zoomOptions.hoverTrigger=!0),window.ekm&&window.ekm.productImageCarouselSettings&&(r=function t(e){for(var i=z(arguments),n=1,a=i.length;n<a;n++){var s=i[n];for(var o in s)s.hasOwnProperty(o)&&(e[o]=s[o])}return e}(r,window.ekm.productImageCarouselSettings)),r.bullets=r.bullets.map(function(t){return z(document.querySelectorAll(t))}),r.leftNavigation&&(r.leftNavigation=z(document.querySelectorAll(r.leftNavigation))),r.rightNavigation&&(r.rightNavigation=z(document.querySelectorAll(r.rightNavigation))),function a(o,r){var h,l,c,m,A;function T(t,e){return e.trackedElementX=t.x,e.trackedElementY=t.y,e.trackedElementWidth=t.width,e.trackedElementHeight=t.height,e}function w(t,e){return e.panInitialOffset=e.panOffset,e.panLastTickTime=0,e.panVelocitySamples=[],e.panVelocity=0,e}function y(t,e){var n=e.panOffset;if(e.panOffset=e.panInitialOffset+t.x/e.trackedElementWidth,e.interactionContext=i,null!==e.panAnimationFrameId&&(f(e.panAnimationFrameId),e.panAnimationFrameId=null),0!==e.panLastTickTime){var a,s,o,r,h=+new Date-e.panLastTickTime;0!==h&&(a=e,s=(e.panOffset-n)/h,(o=a.panVelocitySamples).unshift(s)>12&&(a.panVelocitySamples=o.slice(0,12)),r=a.panVelocitySamples.reduce(function(t,e){return t+e},0),a.panVelocity=r/a.panVelocitySamples.length)}return e.panLastTickTime=+new Date,e}function x(e,i){return b(i),i.panLastTickTime=+new Date,i.panVelocitySamples=[],i.interactionContext=t,i.panAnimationFrameId=g(function(){h.dispatch({type:"PAN_VELOCITY_SETTLE_UPDATE"})}),i}function I(t,e){return e.panOffset=t.x,e}function S(i,n){if(n.interactionContext!==t)return n;if(.001>Math.abs(n.panVelocity)){var a,s;return n.panLastTickTime=0,n.panAnimationFrameId=null,b(s=n),s.panInitialOffset=0,s.interactionContext=e,new E(400,s.panOffset,0,{tick:function(t){h.dispatch({type:"PAN_SETTLE_UPDATE",x:t})},complete:function(){h.dispatch({type:"PAN_SETTLE_DONE"})}}).start(),s}var o=+new Date,r=o-n.panLastTickTime;return n.panOffset+=n.panVelocity*r,n.panVelocity=.9*n.panVelocity,n.panLastTickTime=o,b(n),n.panAnimationFrameId=g(function(){h.dispatch({type:"PAN_VELOCITY_SETTLE_UPDATE"})}),n}function k(e,i){return i.interactionContext=t,i.elementSlideMap.set(0,i.panSlide),i}function P(t,e){if(!e.useZoom)return e;var i=e.imageData[e.panSlide],a=e.trackedElementWidth,s=e.trackedElementHeight;return a>i.full.width&&s>i.full.height||(e.zoomTigger=t.trigger,e.interactionContext=n,e.zoomSlide=e.panSlide,e.zoomFocusX=u(t.x/e.trackedElementWidth,0,1),e.zoomFocusY=u(t.y/e.trackedElementHeight,0,1),e.trackedElementWidth>i.full.width&&(e.zoomFocusX=.5),e.trackedElementHeight>i.full.height&&(e.zoomFocusY=.5),null!==e.zoomAlphaTween&&(e.zoomAlphaTween.stop(),e.zoomAlphaTween=null),e.zoomAlphaTween=new E(400,e.zoomAlpha,1,{tick:function(t){h.dispatch({type:"UPDATE_ZOOM_ALPHA",alpha:t})},complete:function(){h.dispatch({type:"UPDATE_ZOOM_ALPHA",alpha:1})}}),e.zoomAlphaTween.start()),e}function C(t,e){e.zoomFocusX=u(t.x/e.trackedElementWidth,0,1),e.zoomFocusY=u(t.y/e.trackedElementHeight,0,1);var i=e.imageData[e.panSlide];return e.trackedElementWidth>i.full.width&&(e.zoomFocusX=.5),e.trackedElementHeight>i.full.height&&(e.zoomFocusY=.5),e}function O(e,i){return i.interactionContext=t,null!==i.zoomAlphaTween&&(i.zoomAlphaTween.stop(),i.zoomAlphaTween=null),i.zoomAlphaTween=new E(400,i.zoomAlpha,0,{tick:function(t){h.dispatch({type:"UPDATE_ZOOM_ALPHA",alpha:t})},complete:function(){h.dispatch({type:"UPDATE_ZOOM_ALPHA",alpha:0})}}),i.zoomAlphaTween.start(),i}function D(t,e){return e.zoomAlpha=t.alpha,e}function M(e,i){var n=i.elements[e.slide],a=i.imageData.map(function(t){return t.originalElement}).indexOf(n);if(-1===a)return i;var s=i.panSlide;if(i.panSlide=a,i.panLastTickTime=0,i.panVelocitySamples=[],i.panVelocity=0,null!==i.panAnimationFrameId&&(f(i.panAnimationFrameId),i.panAnimationFrameId=null),i.interactionContext=t,e.swapThumbs&&s!==a){i.elementSlideMap=W(i.elementSlideMap);var o,r,h,l,c,d,u=i.elementSlideMap.get(0),m=(o=i.elementSlideMap,r=a,h=null,o.forEach(function(t,e){o.get(e)===r&&(h=e)}),h);i.elementSlideMap.set(0,a),0===(l=i.elementSlideMap,c=u,d=0,l.forEach(function(t){t===c&&d++}),d)&&i.elementSlideMap.set(m,u)}return i}function _(t,e){if(e.imageData[e.panSlide].isVideo)return ekmPlayProductVideo(e.imageData[e.panSlide].videoData),e;if(e.useLightbox){var i=e.imageData.map(function(t){return t.isVideo?ekm.$("<a />").attr({href:t.full.src,"data-video":JSON.stringify(t.videoData)})[0]:ekm.$("<a />").attr("href",t.full.src)[0]});ekm.$(i).lightBox({margin:30,top:15}),i[e.panSlide].click()}else e.imageData[e.panSlide].originalElement.cloneNode().click();return e}function L(t,i){return i.interactionContext=e,R(i.elements,function(t){h.dispatch({type:"IMAGE_DATA_UPDATED",data:t})}),i.isUpdateingImageData=!0,i}function z(e,i){return i.interactionContext=t,i.imageData=e.data,i.visibleElements=p(i.elements,i.imageData),i.panSlide=0,i.elementSlideMap=$(i.elements,!1),i.isUpdateingImageData=!1,i}function N(t,e){return e.badges=t.badges,e.badgeWrapperX=t.wrapperRect.x,e.badgeWrapperY=t.wrapperRect.y,e.badgeWrapperWidth=t.wrapperRect.width,e.badgeWrapperHeight=t.wrapperRect.height,e}function H(t,i){return i.interactionContext===e?i:(i.interactionContext=e,i.panSlide=d(i.panSlide+1,i.imageData.length),i.panOffset=i.panOffset-1,i.elementSlideMap.set(0,i.panSlide),null!==i.panAnimationFrameId&&(f(i.panAnimationFrameId),i.panAnimationFrameId=null),new E(400,i.panOffset,0,{tick:function(t){h.dispatch({type:"PAN_DIR_UPDATE",x:t})},complete:function(){h.dispatch({type:"PAN_DIR_DONE"})}}).start(),i)}function U(t,i){return i.interactionContext===e?i:(i.interactionContext=e,i.panSlide=d(i.panSlide-1,i.imageData.length),i.panOffset=i.panOffset+1,i.elementSlideMap.set(0,i.panSlide),null!==i.panAnimationFrameId&&(f(i.panAnimationFrameId),i.panAnimationFrameId=null),new E(400,i.panOffset,0,{tick:function(t){h.dispatch({type:"PAN_DIR_UPDATE",x:t})},complete:function(){h.dispatch({type:"PAN_DIR_DONE"})}}).start(),i)}function F(t,e){return e.panOffset=t.x,e}function X(e,i){return i.interactionContext=t,i}function Y(t,e){e.panImageData=t.data,e.panImageUrl=t.url,e.panImageSrcs=t.imgSrcs,e.panImageWidth=t.frameWidth,e.panImageHeight=t.frameHeight,clearTimeout(l);var i=new Image;return i.onload=function(){l=setTimeout(function(){h.getState().panImageSrcs===t.imgSrcs&&h.getState().panImageWidth===t.frameWidth&&h.getState().panImageHeight===t.frameHeight&&(h.dispatch({type:"PAN_IMAGE_LOADED",url:t.url,imgSrcs:t.imgSrcs,frameWidth:t.frameWidth,frameHeight:t.frameHeight}),URL.revokeObjectURL(t.url))},1e3)},i.src=t.url,e}function B(t,e){return e.panImageLoaded=!0,e}function G(t,i){return i.panInitialOffset=0,i.panVelocitySamples=[],i.interactionContext=e,i.panVelocity=0,new E(200,i.panOffset,0,{tick:function(t){h.dispatch({type:"PAN_SETTLE_UPDATE",x:t})},complete:function(){h.dispatch({type:"PAN_SETTLE_DONE"})}}).start(),i}function V(t,e){return(e.isIntersecting=t.isIntersecting,e.isIntersecting)?e:Z(t,e)}function Z(t,e){e.elementSlideMap=W(e.elementSlideMap);var i,n,a=(i=e.elementSlideMap,n=[],i.forEach(function(t,e){n[n.length]=e}),n);a=a.slice(0,e.imageData.length);var s=Math.max.apply(null,a),o=e.elementSlideMap.get(0);return a.forEach(function(t){0!==t&&(++o>s&&(o=0),e.elementSlideMap.set(t,o))}),e}function q(t,e){return e.animationMode=t.mode,e}c=o,m=function(t){h=new v(t,function(t,e){var i={TRACKED_ELEMENT_CHANGE:T,INTERACTION_START:w,PAN_UPDATE:y,PAN_SETTLE:x,PAN_SETTLE_UPDATE:I,PAN_VELOCITY_SETTLE_UPDATE:S,PAN_SETTLE_DONE:k,ZOOM_START:P,ZOOM_UPDATE:C,ZOOM_STOP:O,UPDATE_ZOOM_ALPHA:D,GOTO_SLIDE:M,OPEN_IMAGE:_,UPDATE_IMAGE_DATA:L,IMAGE_DATA_UPDATED:z,BADGE_CHANGED:N,PAN_RIGHT:H,PAN_LEFT:U,PAN_DIR_UPDATE:F,PAN_DIR_DONE:X,PAN_IMAGE_DATA_UPDATED:Y,PAN_IMAGE_LOADED:B,PAN_CANCEL:G,INTERSECTION_CHANGE:V,RESET_THUMBNAIL_ORDER:Z,UPDATE_ANIMATION_MODE:q}[t.type];return i?i(t,e):e}),r(h)},R(A=c.elements,function(e){m({elements:A,visibleElements:p(A,e),elementSlideMap:$(A),isIntersecting:!1,isUpdateingImageData:!1,useLightbox:c.lightbox,useZoom:c.zoom,useZoomGlass:c.zoomOptions.glass,useZoomHoverTrigger:!!c.zoomOptions.hoverTrigger,allowUpscaling:!!c.allowUpscaling,context:"idle",interactionContext:t,imageData:e,animationMode:s,panImageData:[],panImageUrl:"",panImageSrcs:"",panFrameWidth:0,panFrameHeight:0,panImageLoaded:!1,panSlide:0,panInitialOffset:0,panOffset:0,panVelocity:0,panVelocitySamples:[],panLastTickTime:0,panAnimationFrameId:null,zoomSlide:0,zoomAlpha:0,zoomFocusX:0,zoomFocusY:0,zoomAlphaTween:null,zoomOrigin:c.zoomOptions.position||"center",zoomOffsetX:c.zoomOptions.offsetX||0,zoomOffsetY:c.zoomOptions.offsetY||0,zoomTigger:null,trackedElementX:0,trackedElementY:0,trackedElementWidth:0,trackedElementHeight:0,badgeWrapperX:0,badgeWrapperY:0,badgeWrapperWidth:0,badgeWrapperHeight:0,badges:[]})})}(r,function(t){h(t);var e=U();if(null!==e){new T(t,e);var i=new O(t);document.body.appendChild(i.toElement());var n=A(o);z(document.querySelectorAll('[id^="_EKM_PRODUCTIMAGE_"]')).forEach(function(e){window.ekm&&ekm.$&&ekm.$.fn.lightBox&&ekm.$(e).unbind(),e.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=parseInt(e.getAttribute("data-pic-thumb-id")||n.indexOf(F(e.id)),10);t.dispatch({type:"GOTO_SLIDE",slide:a,swapThumbs:!0})})}),new L(t);var a=c(function(){t.dispatch({type:"UPDATE_IMAGE_DATA"})},null,17),s=function(t){t.forEach(function(t){var e=t.attributeName;("href"===e||"data-thumbnailimg"===e||"data-largeimg"===e)&&a()})};o.forEach(function(t){new MutationObserver(s).observe(t,{attributes:!0,childList:!1,subtree:!1})}),r.leftNavigation&&r.leftNavigation.forEach(function(e){e.addEventListener("click",function(e){t.dispatch({type:"PAN_LEFT"})})}),r.rightNavigation&&r.rightNavigation.forEach(function(e){e.addEventListener("click",function(e){t.dispatch({type:"PAN_RIGHT"})})}),r.bullets.forEach(function(e,i){e.forEach(function(e){e.addEventListener("click",function(e){t.dispatch({type:"GOTO_SLIDE",slide:i})})})}),r.bullets.length&&new _(t,r),t.dispatch({type:"APP_START"})}})}),r}();